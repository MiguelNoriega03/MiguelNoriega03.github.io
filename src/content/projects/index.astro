---
import { getCollection } from 'astro:content';
import Button from '../components/Button.astro';
import Hero from '../components/Hero.astro';
import PostPreview from '../components/PostPreview.astro';
import siteConfig from '../data/site-config';
import BaseLayout from '../layouts/BaseLayout.astro';
import { sortItemsByDateDesc } from '../utils/data-utils';

const posts = (await getCollection('blog')).sort(sortItemsByDateDesc);
const featuredPosts = posts.filter(({ data }) => data.isFeatured);

const projects = (await getCollection('projects')).sort(sortItemsByDateDesc);
const featuredProjects = projects.filter(({ data }) => data.isFeatured);
---

<BaseLayout description={siteConfig.description}>
    <Hero {...siteConfig.hero} />
    {
        featuredProjects?.length > 0 && (
            <div class="mb-16 sm:mb-24">
                {/* Cards Tendenzza Results */}
                <div class="space-y-10 sm:space-y-12">
                    <div class="rounded-lg border border-main/20 bg-white dark:bg-zinc-900 dark:border-zinc-700 p-6 shadow-sm">
                        <h3 class="font-serif text-lg sm:text-xl font-semibold mb-2">Tendenzza — Stage 1: Commercial System</h3>
                        <div class="mb-2 text-sm text-theme-foreground/90">Arquitectura de negociación end-to-end + sistema comercial de 6 fases + 5 scripts operativos + herramientas de cotización y pagos.</div>
                        <div class="flex flex-wrap gap-2 mb-4">
                            <span class="inline-block rounded-full bg-green-100 px-3 py-1 text-xs font-semibold text-green-800">+32% sales (month 1)</span>
                            <span class="inline-block rounded-full bg-blue-100 px-3 py-1 text-xs font-semibold text-blue-800">+48% quote productivity (month 1)</span>
                            <span class="inline-block rounded-full bg-purple-100 px-3 py-1 text-xs font-semibold text-purple-800">1 → 3 sales channels</span>
                        </div>
                        <a href="/projects/tendenzza-stage-1" class="inline-flex items-center gap-2 rounded border border-red-600 px-5 py-2 text-red-600 font-semibold hover:bg-red-50 transition-colors">View Case</a>
                    </div>
                    <div class="rounded-lg border border-main/20 bg-white dark:bg-zinc-900 dark:border-zinc-700 p-6 shadow-sm">
                        <h3 class="font-serif text-lg sm:text-xl font-semibold mb-2">Tendenzza — Stage 2: Elite Team</h3>
                        <div class="mb-2 text-sm text-theme-foreground/90">Contratación de 6 diseñadores y 1 arquitecto para expansión. Integración de talento excepcional.</div>
                        <div class="flex flex-wrap gap-2 mb-4">
                            <span class="inline-block rounded-full bg-green-100 px-3 py-1 text-xs font-semibold text-green-800">70% ROI on hires</span>
                        </div>
                        <a href="/projects/tendenzza-stage-2" class="inline-flex items-center gap-2 rounded border border-red-600 px-5 py-2 text-red-600 font-semibold hover:bg-red-50 transition-colors">View Case</a>
                    </div>
                    <div class="rounded-lg border border-main/20 bg-white dark:bg-zinc-900 dark:border-zinc-700 p-6 shadow-sm">
                        <h3 class="font-serif text-lg sm:text-xl font-semibold mb-2">Tendenzza — Stage 3: Expansion</h3>
                        <div class="mb-2 text-sm text-theme-foreground/90">Apertura exitosa de 2 showrooms + operación activa + posicionamiento comercial.</div>
                        <div class="flex flex-wrap gap-2 mb-4">
                            <span class="inline-block rounded-full bg-blue-100 px-3 py-1 text-xs font-semibold text-blue-800">2 new showrooms live</span>
                        </div>
                        <a href="/projects/tendenzza-stage-3" class="inline-flex items-center gap-2 rounded border border-red-600 px-5 py-2 text-red-600 font-semibold hover:bg-red-50 transition-colors">View Case</a>
                    </div>
                </div>
                <div class="mt-12 sm:mt-16 flex justify-center">
                    <a
                        href="https://wa.me/525559446719?text=Hola%2C%20me%20gustar%C3%ADa%20agendar%20un%20acercamiento%20inicial"
                        target="_blank"
                        rel="noopener noreferrer"
                        style="display: inline-block; background-color: #16a34a; color: white; padding: 14px 32px; text-decoration: none; border-radius: 9999px; font-weight: 700; font-size: 1.125rem; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); transition: all 0.3s ease;"
                    >
                        Acercamiento inicial
                    </a>
                </div>
            </div>
    {
        featuredPosts?.length > 0 && (
            <div class="mb-16 sm:mb-24">
                <h2 class="mb-12 font-serif text-xl italic sm:mb-16 sm:text-2xl">¿Quiénes somos?</h2>
                {featuredPosts.map((post) => (
                    <PostPreview post={post} class="mb-10 sm:mb-12" headingLevel="h3" />
                ))}
                <div class="mt-12 sm:mt-16">
                    <Button href="/tags">Conócelos más</Button>
                </div>
            </div>
        )
    }  </a>
        </div>
    </div>
</BaseLayout>
